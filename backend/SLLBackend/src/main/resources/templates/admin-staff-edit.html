<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title th:text="#{admin-edit-staff-profile.pageTitle}">Admin - Edit Staff Profile | Salon Loan Loan</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Global staff layout styles (sidebar + main scroll) -->
    <link rel="stylesheet" th:href="@{/css/styles.css}" />

    <style>
        /* ===== PAGE STRUCTURE ===== */
        .admin-staff-edit-page {
            padding: 2.5rem 0 3rem;
            background: var(--bg-light);
            min-height: 100vh;
        }

        .admin-staff-edit-layout-inner {
            max-width: 70vw;
            width: 100%;
            margin: 1rem auto;
        }

        .admin-staff-edit-card {
            background: #ffffff;
            padding: 2.2rem;
            border-radius: var(--radius-lg);
            border: 1px solid #e8e8e8;
            box-shadow: var(--shadow-soft);
        }

        /* ===== HEADER ===== */
        .admin-staff-edit-header-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .admin-staff-edit-title-block {
            text-align: left;
        }

        .admin-staff-edit-title-block .section-kicker {
            margin-bottom: 0.25rem;
        }

        .admin-staff-edit-title-block h2 {
            margin: 0;
        }

        .admin-staff-edit-meta {
            font-size: 0.85rem;
            color: #6b7280;
        }

        /* ===== ALERTS ===== */
        .alert {
            padding: 0.7rem 0.9rem;
            margin-bottom: 1rem;
            border-radius: 12px;
            font-size: 0.9rem;
        }

        .alert-success {
            background: #ecfdf3;
            color: #166534;
            border: 1px solid #bbf7d0;
        }

        .alert-error {
            background: #fef2f2;
            color: #b91c1c;
            border: 1px solid #fecaca;
        }

        /* ===== FORM LAYOUT ===== */
        .form-section-title {
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: .08em;
            color: #6b7280;
            margin: 1.2rem 0 0.7rem;
        }

        .form-grid-2 {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 1.1rem 1.5rem;
        }

        @media (max-width: 800px) {
            .admin-staff-edit-layout-inner {
                max-width: 95vw;
            }
            .form-grid-2 {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        .field-group {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .field-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #374151;
        }

        .field-input,
        .field-select {
            padding: 0.55rem 0.7rem;
            border-radius: 10px;
            border: 1px solid #d1d5db;
            font-size: 0.9rem;
            background: #ffffff;
        }

        .field-input[readonly],
        .field-select[disabled] {
            background: #f9fafb;
            color: #6b7280;
            cursor: not-allowed;
        }

        .field-input:focus,
        .field-select:focus {
            outline: none;
            border-color: var(--accent-soft);
            box-shadow: 0 0 0 1px rgba(100,179,255,0.35);
        }

        /* ===== ACTIONS ===== */
        .form-actions {
            margin-top: 2rem;
            display: flex;
            justify-content: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.5rem 1.4rem;
            border-radius: 999px;
            border: none;
            cursor: pointer;
            font-size: 0.88rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            text-decoration: none;
        }

        .btn-primary {
            background: #16a34a;
            color: #ffffff;
            box-shadow: 0 8px 18px rgba(22,163,74,0.18);
        }

        .btn-primary:hover {
            background: #15803d;
        }

        .btn-secondary {
            background: #ffffff;
            color: #111827;
            border: 1px solid #d1d5db;
        }

        .btn-secondary:hover {
            background: #f3f4f6;
        }
    </style>
</head>
<body class="staff-layout">

<!-- Sidebar -->
<div th:replace="~{fragments/staff-sidebar :: staff-site-header}"></div>

<!-- MAIN CONTENT -->
<main class="staff-main admin-staff-edit-page">
    <div class="admin-staff-edit-layout-inner">
        <section class="admin-staff-edit-card">

            <!-- Header -->
            <header class="admin-staff-edit-header-row">
                <div class="admin-staff-edit-title-block section-heading">
                    <p class="section-kicker" th:text="#{admin-edit-staff-profile.kicker}">Account Management</p>
                    <h2 th:text="#{admin-edit-staff-profile.title}">Edit Staff Profile</h2>
                    <p class="admin-staff-edit-meta">
                        <span th:text="#{admin-edit-staff-profile.usernameLabel}">Username:</span>
                        <span th:text="${staffAccount.username}">staff.username</span>
                    </p>
                </div>
            </header>

            <!-- Alerts -->
            <div th:if="${param.error}" class="alert alert-error"
                 th:text="#{admin-edit-staff-profile.alert.updateError}">
                Update error. Please check the information and try again.
            </div>
            <div th:if="${param.updated}" class="alert alert-success"
                 th:text="#{admin-edit-staff-profile.alert.updated}">
                Staff profile updated successfully.
            </div>

            <!-- Form -->
            <form th:action="@{/admin/profiles/staff/update/{id}(id=${staffAccount.id})}" method="post">

                <!-- Account Info -->
                <div class="form-section-title" th:text="#{admin-edit-staff-profile.section.accountInfo}">Account Info</div>
                <div class="form-grid-2">
                    <div class="field-group">
                        <label class="field-label" th:text="#{admin-edit-staff-profile.field.username}">Username</label>
                        <input type="text"
                               class="field-input"
                               th:value="${staffAccount.username}"
                               readonly />
                    </div>

                    <div class="field-group">
                        <label class="field-label" th:text="#{admin-edit-staff-profile.field.accountStatus}">Account Status</label>
                        <select name="accountStatus"
                                class="field-select"
                                disabled>
                            <option th:value="ACTIVE"
                                    th:selected="${staffAccount.accountStatus != null and staffAccount.accountStatus.name() == 'ACTIVE'}"
                                    th:text="#{common.active}">
                                Active
                            </option>
                            <option th:value="DEACTIVATED"
                                    th:selected="${staffAccount.accountStatus != null and staffAccount.accountStatus.name() == 'DEACTIVATED'}"
                                    th:text="#{common.deactivated}">
                                Deactivated
                            </option>
                        </select>
                    </div>
                </div>

                <!-- Staff Details -->
                <div class="form-section-title" th:text="#{admin-edit-staff-profile.section.staffDetails}">Staff Details</div>
                <div class="form-grid-2">
                    <div class="field-group">
                        <label class="field-label" th:text="#{admin-edit-staff-profile.field.name}">Name</label>
                        <input type="text"
                               name="name"
                               class="field-input"
                               th:value="${staffAccount.staff.name}" />
                    </div>

                    <div class="field-group">
                        <label class="field-label" th:text="#{admin-edit-staff-profile.field.email}">Email</label>
                        <input type="email"
                               name="email"
                               class="field-input"
                               th:value="${staffAccount.staff.email}" />
                    </div>

                    <div class="field-group">
                        <label class="field-label" th:text="#{admin-edit-staff-profile.field.staffStatus}">Staff Status</label>
                        <select name="staffStatus" class="field-select">
                            <option th:value="ACTIVE"
                                    th:selected="${staffAccount.staff.staffStatus.name() == 'ACTIVE'}"
                                    th:text="#{common.active}">
                                Active
                            </option>
                            <option th:value="ON_LEAVE"
                                    th:selected="${staffAccount.staff.staffStatus.name() == 'ON_LEAVE'}"
                                    th:text="#{admin-edit-staff-profile.staffStatus.onLeave}">
                                On Leave
                            </option>
                            <option th:value="TERMINATED"
                                    th:selected="${staffAccount.staff.staffStatus.name() == 'TERMINATED'}"
                                    th:text="#{admin-edit-staff-profile.staffStatus.terminated}">
                                Terminated
                            </option>
                        </select>
                    </div>

                    <div class="field-group">
                        <label class="field-label" th:text="#{admin-edit-staff-profile.field.ssn}">Social Security Number</label>
                        <input type="text"
                               name="socialSecurityNum"
                               class="field-input"
                               th:value="${staffAccount.staff.socialSecurityNum}" />
                    </div>

                    <div class="field-group">
                        <label class="field-label" th:text="#{admin-edit-staff-profile.field.dateHired}">Date Hired</label>
                        <input type="text"
                               class="field-input"
                               th:value="${#temporals.format(staffAccount.staff.dateHired, 'dd MMM yyyy')}"
                               readonly />
                    </div>

                    <div class="field-group">
                        <label class="field-label" th:text="#{admin-edit-staff-profile.field.birthDate}">Birth Date</label>
                        <input type="text"
                               name="birthDate"
                               class="field-input"
                               th:value="${#temporals.format(staffAccount.staff.birthDate, 'yyyy-MM-dd')}" />
                    </div>

                    <div class="field-group">
                        <label class="field-label" th:text="#{admin-edit-staff-profile.field.endOfContract}">End of Contract</label>
                        <input type="text"
                               class="field-input"
                               th:value="${staffAccount.staff.endOfContractDate != null ? #temporals.format(staffAccount.staff.endOfContractDate, 'yyyy-MM-dd') : #{common.emDash}}"
                               readonly />
                    </div>
                </div>

                <!-- Actions -->
                <div class="form-actions">
                    <a href="/admin/profiles" class="btn btn-secondary">
                        <span aria-hidden="true">âœ•</span> <span th:text="#{common.cancel}">Cancel</span>
                    </a>
                    <button type="submit" class="btn btn-primary">
                        <span aria-hidden="true">ðŸ’¾</span> <span th:text="#{common.saveChanges}">Save Changes</span>
                    </button>
                </div>

            </form>
        </section>
    </div>
</main>

</body>
</html>
